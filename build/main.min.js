ShaderManager.Manager=function(a){if(!(a instanceof WebGLRenderingContext))throw new TypeError("Error: attempted to create ShaderManager with illegal argument.");this.context=a,this.vertShaders={},this.fragShaders={},this.programs={},this.shaderFactory=new ShaderManager.ShaderFactory(this)},ShaderManager.Manager.prototype={addShader:function(a){this.shaderFactory.addShader(a)},draw:function(a,r,e,t,n){this.getProgram(a,r).draw(e,t,n)},getProgram:function(a,r){return this.programs[a][r]},getShader:function(a,r){return a===ShaderManager.Shader.VS?this.vertShaders[r]:this.fragShaders[r]}},ShaderManager.Manager.prototype.constructor=ShaderManager.Manager,ShaderManager.Program=function(a,r,e){this.context=a,this.vs=r,this.fs=e},ShaderManager.Program.prototype={draw:function(){},restoreDefaultConfig:function(){},setConfig:function(){}},ShaderManager.Program.VS_MODE=0,ShaderManager.Program.FS_MODE=1,ShaderManager.Program.BOTH_MODE=2,ShaderManager.Program.prototype.constructor=ShaderManager.Program,ShaderManager.Shader=function(a,r,e,t,n){this.name=r,this.type=e,this.shader=0,this.context=a,this.attrs=n},ShaderManager.Shader.VS=0,ShaderManager.Shader.FS=1,ShaderManager.Shader.LIST=2,ShaderManager.Shader.prototype.constructor=ShaderManager.Shader,ShaderManager.ShaderFactory=function(a){this.manager=a},ShaderManager.ShaderFactory.prototype={addShader:function(a){var r,e;switch(this.establishType(a)){case ShaderManager.ShaderFactory.SOURCE_OBJECT:r=a;case ShaderManager.ShaderFactory.JSON:r=r||JSON.parse(a),e=this.createShaderObject(r);break;case ShaderManager.ShaderFactory.SHADER_OBJECT:e=a;break;case ShaderManager.ShaderFactory.URL:this.downloadFromURL(a);break;default:throw new Exception("Not a valid type of shader.")}e&&this.registerShader(e)},createShaderObject:function(a){switch(a.type){case ShaderManager.Shader.VS:case ShaderManager.Shader.FS:return new Shader(this.manager.context,a.name,a.type,a.src,a.attrs);case ShaderManager.Shader.LIST:for(var r=a.content.length-1;r>=0;r--)this.addShader(a.content[r]);break;default:throw new Exception("Tried to create an illegal class of shader.")}},downloadFromURL:function(a){var r=new XMLHttpRequest;r.open("GET",a,!0),r.onload=function(){this.addShader(r.response)},r.send()},establishType:function(a){var r=-1;a instanceof ShaderManager.Shader?r=ShaderManager.ShaderFactory.SHADER_OBJECT:a.type&&a.name&&(a.content||a.src)?r=ShaderManager.ShaderFactory.SOURCE_OBJECT:this.isJSON(a)?r=ShaderManager.ShaderFactory.JSON:a instanceof String&&(r=ShaderManager.ShaderFactory.URL)},isJSON:function(a){try{{JSON.parse(a)}return!0}catch(r){return!1}},registerShader:function(a){switch(a.type){case ShaderManager.Shader.VS:this.manager.vertShaders[a.name]=this.manager.vertShaders[a.name]||a;break;case ShaderManager.Shader.FS:this.manager.fragShaders[a.name]=this.manager.fragShaders[a.name]||a;break;default:throw new Exception("Tried to register an illegal class of shader.")}}},ShaderManager.ShaderFactory.SOURCE_OBJECT=0,ShaderManager.ShaderFactory.JSON=1,ShaderManager.ShaderFactory.URL=2,ShaderManager.ShaderFactory.SHADER_OBJECT=3,ShaderManager.ShaderFactory.prototype.constructor=ShaderManager.ShaderFactory;var ShaderManager=ShaderManager||{};